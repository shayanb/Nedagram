<p align="center">
  <img src="public/icons/logo.png" alt="Nedagram Logo" width="250" />
</p>

# نداگرام

[English](README.md) | فارسی

**انتقال متن از طریق صدا** - یک برنامه وب پیش‌رونده (PWA) که متن را به سیگنال‌های صوتی تبدیل می‌کند تا بین دستگاه‌ها با استفاده از بلندگو و میکروفون (تماس تلفنی) منتقل شود.

## چرا نداگرام؟

نداگرام برای کمک به اشتراک‌گذاری متن در شرایطی ساخته شده که ارسال فایل و کپی-پیست ممکن نیست. با تبدیل متن به صدا، می‌توانید:

- داده‌ها را از طریق **تماس تلفنی** (موبایل، ثابت یا VoIP) به اشتراک بگذارید
- بدون هیچ اتصال اینترنتی بین دستگاه‌ها انتقال دهید
- پس از اولین بازدید **کاملاً آفلاین** کار کنید
- داده‌های خود را با رمز عبور **رمزنگاری** کنید

## نحوه کار

```
┌─────────────┐    امواج     ┌─────────────┐
│   فرستنده   │     صوتی     │    گیرنده   │
│             │   ~~~~~~~~>  │             │
│  ورودی متن  │   بلندگو     │   میکروفون  │
│      ↓      │     به       │      ↓      │
│  رمزنگاری*  │   میکروفون   │   رمزگشایی  │
│      ↓      │    (تلفن)    │      ↓      │
│  فشرده‌سازی│              │   رمزگشایی FEC│
│      ↓      │              │      ↓      │
│ کدگذاری FEC │              │ از فشرده‌سازی│
│      ↓      │              │      ↓      │
│  صدای MFSK  │              │ رمزگشایی*   │
└─────────────┘              └─────────────┘
                           * در صورت رمزنگاری
```

1. **فرستنده** متن را وارد می‌کند (فایل تنظیمات، رمز عبور، لینک و غیره)
2. اختیاری: داده‌ها را با رمز عبور رمزنگاری می‌کند
3. برنامه داده‌ها را فشرده و با تصحیح خطا کدگذاری می‌کند
4. داده‌ها به تن‌های صوتی (MFSK) مدوله می‌شوند
5. **گیرنده** صدا را از طریق میکروفون دریافت می‌کند
6. برنامه رمزگشایی کرده، خطاها را اصلاح و در صورت نیاز رمزگشایی می‌کند
7. هر دو طرف جمع کنترلی SHA-256 را تأیید می‌کنند

## ویژگی‌ها

- **آفلاین-اول PWA** - پس از اولین بارگذاری بدون اینترنت کار می‌کند
- **رمزنگاری سرتاسری** - رمزنگاری اختیاری ChaCha20-Poly1305 با محافظت رمز عبور
- **دو حالت صوتی**
  - **حالت Phone** - برای تماس‌های تلفنی معمولی (300-3400 Hz)
  - **حالت Wideband** - انتقال سریع‌تر برای مستقیم بین دستگاه‌ها یا HD Voice
- **تصحیح خطا** - Reed-Solomon FEC با 16 بایت پریتی در هر فریم
- **تشخیص خودکار** - گیرنده به صورت خودکار حالت انتقال را تشخیص می‌دهد
- **فشرده‌سازی** - فشرده‌سازی DEFLATE زمان انتقال را کاهش می‌دهد
- **تأیید یکپارچگی** - جمع کنترلی SHA-256 برای تأیید فرستنده/گیرنده
- **جایگزین کد QR** - برای داده‌های کوچک (< 2KB)
- **چند زبانه** - پشتیبانی از انگلیسی و فارسی (RTL)
- **بسته آفلاین قابل دانلود** - خود برنامه را بدون اینترنت به اشتراک بگذارید

## موارد استفاده

### اصلی: اشتراک‌گذاری فایل‌های تنظیمات و اعتبارنامه‌ها
فایل‌های تنظیمات، رمزهای عبور پیچیده، یا لینک‌های طولانی را از طریق:
- تماس تلفنی معمولی
- پیام صوتی در اپلیکیشن‌ها
- مستقیم بلندگو به میکروفون

### سایر موارد
- انتقال داده در کامپیوترهای ایزوله (air-gapped)
- کدهای پشتیبان و اعتبارنامه‌ها
- پیام‌های متنی در ارتباطات رادیویی
- هر سناریویی که انتقال شبکه‌ای در دسترس نیست

## شروع سریع

### ارسال
1. [نداگرام](https://nedagram.com) را در دستگاه فرستنده باز کنید
2. متن خود را وارد کنید یا فایل بارگذاری کنید
3. **Phone** (برای تماس تلفنی) یا **Wideband** (برای انتقال مستقیم) را انتخاب کنید
4. اختیاری: **رمزنگاری** را فعال کرده و رمز عبور وارد کنید
5. روی **ایجاد صدا** کلیک کنید
6. صدا را نزدیک دستگاه گیرنده پخش کنید
7. جمع کنترلی SHA-256 (و رمز عبور در صورت رمزنگاری) را با گیرنده به اشتراک بگذارید

### دریافت
1. [نداگرام](https://nedagram.com) را در دستگاه گیرنده باز کنید
2. روی **شروع گوش دادن** کلیک کنید
3. اجازه دسترسی به میکروفون را بدهید
4. منتظر تکمیل انتقال بمانید
5. در صورت رمزنگاری، رمز عبور را برای رمزگشایی وارد کنید
6. تأیید کنید که جمع کنترلی با فرستنده مطابقت دارد
7. متن رمزگشایی شده را کپی یا ذخیره کنید

## مشخصات فنی

### حالت Phone (بهینه‌شده برای تماس تلفنی GSM)
| پارامتر | مقدار |
|---------|-------|
| مدولاسیون | 4-MFSK (2 بیت/سمبل) |
| فرکانس‌های تن | 800، 1300، 1800، 2300 Hz |
| فاصله تن‌ها | 500 Hz (گسترده برای تحمل کدک) |
| مدت سمبل | 50ms + 12ms guard |
| نرخ بیت مؤثر | ~20-25 bps |
| همگام‌سازی | تشخیص فیلتر تطبیقی چیرپ |
| حفاظت از خطای انفجاری | درهم‌ریزی بلوکی فعال |

### حالت Wideband (HD Voice / مستقیم)
| پارامتر | مقدار |
|---------|-------|
| مدولاسیون | 16-MFSK (4 بیت/سمبل) |
| محدوده فرکانس | 1800 - 5700 Hz |
| مدت سمبل | 40ms + 5ms guard |
| نرخ بیت مؤثر | ~50-60 bps |

### تصحیح خطا (Reed-Solomon)
| پارامتر | مقدار |
|---------|-------|
| بایت‌های Parity | 16 در هر فریم |
| تصحیح خطا | تا 8 بایت/فریم |

### همگام‌سازی
| جزء | حالت Phone | حالت Wideband |
|-----|------------|---------------|
| تن گرم‌کننده | 200ms تن ثابت | 400ms تن ثابت |
| جارو چیرپ | 800ms (600-2600 Hz) | 1200ms (1000-4000 Hz) |
| تشخیص | فیلتر تطبیقی همبستگی متقاطع |
| کالیبراسیون | 4 تن × 2 تکرار | 4 تن × 3 تکرار |
| الگوی همگام | الگوی متناوب 8 سمبلی |

### رمزنگاری (اختیاری)
| پارامتر | مقدار |
|---------|-------|
| رمز | ChaCha20-Poly1305 (AEAD) |
| استخراج کلید | PBKDF2-SHA256 (100,000 تکرار) |
| سربار | 44 بایت (16 salt + 12 nonce + 16 auth tag) |

### محدودیت‌ها
- حداکثر حجم داده: 100 KB
- حجم توصیه شده: < 50 KB
- کد QR برای داده‌های < 2 KB

## تخمین زمان انتقال

| حجم داده | حالت Phone | حالت Wideband |
|----------|------------|---------------|
| 100 بایت | ~45 ثانیه | ~20 ثانیه |
| 1 KB | ~6 دقیقه | ~2.5 دقیقه |
| 10 KB | ~55 دقیقه | ~25 دقیقه |

*زمان‌ها تقریبی هستند و شامل پیش‌آهنگ، هدرها و سربار FEC می‌شوند. حالت Phone برای قابلیت اطمینان بهینه شده، نه سرعت.*

## نکات برای بهترین نتیجه

1. **محیط ساکت** - سر و صدای پس‌زمینه دقت را کاهش می‌دهد
2. **صدا روی 70-80%** - خیلی بلند باعث اعوجاج، خیلی آرام باعث از دست رفتن سیگنال می‌شود
3. **فاصله 0.5-1 متر** - محدوده بهینه برای بلندگو به میکروفون
4. **دستگاه‌ها را ثابت نگه دارید** - حرکت در حین انتقال می‌تواند خطا ایجاد کند
5. **جمع کنترلی را تأیید کنید** - همیشه SHA-256 را مقایسه کنید

## توزیع آفلاین

می‌توانید نداگرام را برای استفاده کاملاً آفلاین دانلود کنید - پس از دانلود اولیه نیاز به اتصال اینترنت نیست.

### از طریق وب‌سایت
به صفحه راهنما در [nedagram.com](https://nedagram.com) بروید و روی «دانلود بسته آفلاین» کلیک کنید.

**دانلود مستقیم:** [nedagram.com/nedagram-offline.zip](https://nedagram.com/nedagram-offline.zip)

### ساخت دستی
```bash
# کلون و ساخت
git clone https://github.com/shayanb/nedagram.git
cd nedagram
npm install
npm run build

# فایل zip در dist/nedagram-offline.zip خواهد بود
```

### اجرای آفلاین
۱. فایل ZIP را در یک پوشه استخراج کنید
۲. یک سرور وب محلی راه‌اندازی کنید:
   ```bash
   # با استفاده از Python (توصیه شده)
   python3 -m http.server 8000 --bind 127.0.0.1

   # با استفاده از Node.js
   npx serve .

   # با استفاده از PHP
   php -S 127.0.0.1:8000
   ```
۳. آدرس **http://127.0.0.1:8000** را در مرورگر باز کنید

> **مهم:** از `http://127.0.0.1:8000` استفاده کنید (نه `[::]` یا `localhost`) تا دسترسی میکروفون کار کند. برای دستگاه‌های دیگر در شبکه، از آدرس IP کامپیوتر استفاده کنید (مثلاً `http://192.168.1.x:8000`).

## توسعه

### پیش‌نیازها
- Node.js 18+
- npm

### راه‌اندازی
```bash
# کلون مخزن
git clone https://github.com/shayanb/nedagram.git
cd nedagram

# نصب وابستگی‌ها
npm install

# شروع سرور توسعه (با HTTPS برای دسترسی میکروفون)
npm run dev

# ساخت برای تولید
npm run build

# اجرای تست‌ها
npm test
```

### پشته فناوری
- **فریم‌ورک**: Preact + TypeScript
- **ابزار ساخت**: Vite
- **مدیریت حالت**: Preact Signals
- **فشرده‌سازی**: pako (DEFLATE)
- **رمزنگاری**: @noble/ciphers (ChaCha20-Poly1305)
- **تصحیح خطا**: پیاده‌سازی سفارشی Reed-Solomon
- **PWA**: Service Worker با کش آفلاین

## حریم خصوصی و امنیت

- **بدون تله‌متری** - هیچ داده‌ای به جایی ارسال نمی‌شود
- **بدون سرور** - کاملاً سمت کلاینت
- **قابلیت آفلاین** - پس از اولین بارگذاری بدون شبکه کار می‌کند
- **متن‌باز** - کد را خودتان بررسی کنید
- **رمزنگاری اختیاری** - داده‌های حساس را با رمز عبور محافظت کنید

## پشتیبانی مرورگر

| مرورگر | پشتیبانی |
|--------|----------|
| Chrome (دسکتاپ/اندروید) | کامل |
| Firefox | کامل |
| Safari (macOS/iOS) | کامل |
| Edge | کامل |

*برای دریافت نیاز به اجازه میکروفون دارد.*

## مشارکت

از مشارکت استقبال می‌کنیم! لطفاً issues و pull requests ارسال کنید.

## مجوز

MIT License - برای جزئیات [LICENSE](LICENSE) را ببینید.

## سلب مسئولیت

این نرم‌افزار «همان‌طور که هست» برای اهداف آموزشی و تحقیقاتی ارائه شده است. برای شرایط کامل [DISCLAIMER.md](DISCLAIMER.md) را ببینید.

**توجه:** این کد ممیزی نشده است. پیاده‌سازی کدگذاری/رمزگشایی صوتی بر اساس مقالات تحقیقاتی و کدبیس‌های معتبر در این حوزه توسعه یافته، با کمک هوش مصنوعی و هدایت نویسنده(ها). برای کاربردهای حساس با احتیاط استفاده کنید.

## قدردانی

با هدف کمک به مردم برای برقراری ارتباط آزاد در شرایطی که روش‌های سنتی کار نمی‌کنند ساخته شده است.

---

**نداگرام** - وقتی فناوری کار نمی‌کند، صدا راهی پیدا می‌کند. :telephone_receiver:
